じゃあ、カシュから。
カシュから。
はい。
はい、じゃあよろしくお願いします。
よろしくお願いします。
プハー。
ちゃんと退勤を押しましたか。
（笑）
退勤して、ビール飲んで、ポッドキャスト……
覗きこまれないといいけど……
そうそう
（笑）
すごいオフィスの執務室から見えているっていう。
（笑）

mirakui: じゃあ、さっそく本題に入って行きたいと思いますけど、先日[MySQL Cluster Casual Talks](http://atnd.org/events/50736)っていうのがありましたね。僕とかcon_mameさんは出てましたが、どうでした？
con_mame: まず[ConoHa](https://www.conoha.jp/)がかわいい。
（笑）
mirakui: ConoHaはかわいかったですね。
con_mame: よかったですね。あの[yoku](https://twitter.com/yoku0825)さん（？）っていうMySQLエースの方にすごい迷惑をかけてしまった……
（笑）
mirakui: 結局、実用段階と言っていいんでしょうか、これは。
con_mame: 実用的には、やっぱりなんだろう、MySQL Cluster特有の設定だとか障害みたいな、障害っていうか勘所みたいなのはあるから、それをちゃんと専属でしばらくいじれるモチベーションと人がいれば実用段階なんじゃないかなって思ってて、（聞き取れず）Casual Talksに行って、それを再認識した感じ。
なるほど。
あー。
確かに、すごい執着している人……じゃない？
（笑）
未曾有の罠がありそうな感じが。
やっぱり、他のものと協調して動いてるってとこで、コンカレンシーの問題だったりとか、バッファリングの問題だったりとか、ワークロードで結構違うと思うし、データ量によっても変わってくるから、たぶんベストプラクティスっていうのは存在しない……データベースではあまり存在しないけど……さらにそれが存在しなくなるんじゃないかっていう。
うん。
細かくこう見て、常になんか変化があったらそれに対応できる状態じゃないと、まだちょっと早いんじゃないかな……
ウェブサービスのバックエンドで気軽に使うみたいな感じのものではない？
まだない。特にウェブだとソシャゲとかイベントとか、普通にやってもピークの時間帯とかでワークロードがすごい変わってきたりする場合、どこに合わせるんだみたいな。ピークに当てとくとマシンリソースめっちゃ食うしっていう、のが結構顕著に出ちゃうんじゃないかっていう。
うん。確かに。あと、カリカリにチューンしたすごい高価なハードウェアを大量に使ったMySQL Clusterを運用するなら、そんだけの機材があるなら普通のMySQLでも全然……っていう話が出てましたね、Casual Talksで。
それ普通のMySQLでいいんじゃないのっていう。
通常のIO（？）とか積んでしまうっていう。
それだけの機材があったら普通のMySQLで解決しちゃいそうな。
そうですね。やっぱDBだからメモリから外れた時にどうするかって悩むとこで、いま結構Fusionとかもオンプレミスの環境で安くなってきて入れやすくなってきてはいるから、そこを思うと……どうなんだろうっていう。オンプレの環境では。
MySQL ClusterもオンメモリにしててもIOが出ますって書いてあってましたね。（聞き取れず）ログを書くのに。
ああ、まあログを書くのには……。
ログっつーか、binlogみたいなやつ。
そうですよね……。
（聞き取れず）これを聞いてる人たちはMySQL Clusterを入れるのは、だいぶ覚悟を持って入れてくださいという。執着心。
執着心。
何があってもMySQL Clusterで行くんだという。強い気持ちを持って。
あとまあ、何が変わったかですよね。7.2から7.3で何が変わったかみたいなのをちゃんと。まあそれ多分どんなミドルウェア使うにしても何が変わってどう良くなって、どう変えてやんなきゃいけないかみたいな。たぶん知っとかないと、「あれ？」って。たとえば7.3だとベースがMySQL 5.6に変わったとか。そうすると5.6の設定に引きずられてったりとか、そういうが。まあそのぶん早くなってはいるんですけど。でもそういうのに追従できるとか、意外とまだちょっと辛いんじゃないかなっていう感じがしないでもない。
やっぱね、利用事例がね、大事っすよね。
エンタープライズじゃない、なんか渋谷の会社とかがガンガン使ってるような状況になってたら。
そうですね。
深夜に突撃されても耐えうる……
（笑）
そうっすね。
まあでもチャレンジとして結構扱うのは面白いのかもしれないね。
奥野さんの記事とかを読むと、もう夢のDBだから今すぐ使うしかないみたいな…
（笑）
使わない理由ゼロっていう感じが伝わってくるけど、現場はそんな感じではない雰囲気がしますね。
データストアは難しいですよね。
分散でさらに難しさが上がっている。あと、MySQL Cluster、Casual Talksではオンプレで使うっていう話がすごいメインになっていて、我々が働いているクックパッドではAWSを使っているので、MySQL ClusterをAWSで使うとしたら、どういう構成の選択肢があるのかね。
難しいですよね。オンプレを上手くマッピングできないから、そうですね、作るとしたらfusionだって言ってる部分でデータノードに関してはI2シリーズのインスタンスでephemeral SSDをRAIDで固めてIOPSをめっちゃ稼いで、ノード同士はPlacement Groupっていう物理的に近い場所にインスタンスが配置されて、10Gフルでupもdownも出るっていうPlacement Groupっていう機能がAWSにはHPC用にあって、それに組み込んでやると、結構似たような環境になって、いいんじゃないかとは思うんですよね。IOとネットワークはそれでクリアできるんじゃないかなっていう感じはするんですけど、いかんせんちょっと高い。
（笑）
……のと、やっぱPlacement Groupの欠点は物理的に近いとこにインスタンスを起動するっていうモチベーションなんで、起動してこないことがあるっていう。
へー。
確率が下がるのか。
そう。近くに起動できなかった場合は起動が失敗するっていうのとか、動いてる時にダイナミックにPlacement Groupを切り替えたりできない。まあ後から追加ぐらいだったらいいんですけど。
Placement Groupってどういう課金になるんでしたっけ。
課金はないですね。HPCをAWSでやりたいっていう時にそこに普通に入れてやるとネットワーク的に近くなる。で、フルで10G出るっていう。
でも失敗するかもしれない……。
失敗する可能性が高いと。でもまあ……。
一回（聞き取れず）っちゃえばね。
そうそう。HPC自体は何十台何百台ガンって立てたい時には上がんないとか。普通に十何ノードとかだと多分上がってくるんだろうっていう。ただI2はやっぱりちょっと高いかなっていう。
I2は高いですね。やっぱメモリー、高いすっよね。
（笑）
見かけでは出せないから難しい。
そうですね。
あと、Fusionだと結構Fusion-ioのカードの中でRAIDみたいなの組んで障害耐性上げつつ、さらにカード二枚刺しとかで障害耐性さらに上げるっていう戦略が取れるんですけど、I2だと結局ephemeral SSDに乗っけるしかできないんで、ephemeralが故障したらとか、バックアップ……。バックアップがMySQL Clusterでどこまで重要かっていうのは結構怪しいんですけど、バックアップ・リストアがEBSスナップショットよりかはやりにくいし、時間もまあ掛かるっていう。まあちょっと辛いかなっていう。
そうですね。
（聞き取れず）辛いという。
（笑）
AWSではお金が掛かるし、辛い……。
そうですね。あんまりスペックの高くないインスタンスで上げちゃうと、そもそも1Gしか仮想NICが刺さってなかったりっていう違いが。だからあまりアクセスのないところにMySQL Clusterを入れるんだったらいいかもしれないですけど……。
じゃあ何のために使ってるか分かんない（笑）
M3とかあのへんでメモリーがっつり乗っけちゃえばいいんじゃないのみたいな感じはしますね。
お金がある人向けっていう。
（笑）
そうですね。
お金があったら、もっと商用の分散DBが選択肢に入ってくる気がしますよ。
でも、安いものを並べてパフォーマンスを出す、Hadoopみたいな気持ちで使えないのかなみたいな。
あー。安い設備を買ってきて。
買ってきて並べる。
そういうDIY精神が……。
DIY精神でやるとどうなんだろう。
できるかもしれない。
どうなんですかね。Hadoopは最近は安いハードウェアだと性能出ませんよみたいな……。
（笑）
一番いいやつ使うんでしょ。
出た、Hadoop dis。
（笑）
MySQL Clusterの制限、っていうかまあ、BlobとText型が含まれてはいけないっていうのがありますね。
あー。
そうなんだっけ。
Text辛いですね。
確かに。
現実世界には。
現実世界では使ってるよねっていう。クエリの結果に含まれてはいけないっていう制限があるんで。
ブログシステムが作れない（笑）
（笑）
（聞き取れず）
だからある程度その、まあ動くようなせっ……これ……
だいぶ限定されそうですね、そうしたら。
でも世の中、使ってないんすかね？　BlobとTextは。
うーん。
まあBlobは分かりますけどね。
実際、要ります？
いやあ、でもBlobの中になんか画像……（笑）
あー…（笑）
画像アップロード先がMySQLとか。
まあそういう人たちは素直にRiakとかに置き換えたほうが幸せになれる。
Riak（笑）
Riakになすりつけましたね。
次、行きますか。
5.6の話をしましょう。いま5.6.何？
38。


